1 ' Copyright (c) 2023 emef220 
2 ' Released under the MIT license
3 ' https://opensource.org/licenses/mit-license.php
4 '
5 ' --------------------------------------------------------------------------
6 ' 019_Hyper2_with_analog_volume
7 ' --------------------------------------------------------------------------
8 '
10 CLS:COLOR 15,0,1:SCREEN 5':OPEN "GRP:" FOR OUTPUT AS #1
20 BLOAD "HYPER2.SC5",S
30 COLOR = RESTORE
40 _TURBOON:DIM P(8),Q(8):C1%=&H26:C2%=&H3:D1%=&H0:D2%=&H0
50 D$="sample/analog":GOSUB1000
60 GOSUB 200: GOSUB 2036:GOTO 2040
70 IF INKEY$="" THEN 70
80 END
200 GOSUB1000'R=INT(RND(1)*4095)'
209 'PSET(0,0):PRINT#1,"R"R
210 R1%=(R\16)AND7:G1%=(R\8)AND7:B1%=(RAND15)AND7':PSET(0,8):PRINT#1,"R1"R1%"G1"G1%"B1"B1%
211 R2%=B1%:G2%=R1%:B2%=G1%':PSET(0,16):PRINT#1,"R2"R2%"G2"G2%"B2"B2%
212 C1%=R1%*8+G1%:C2%=B1%:D1%=R2%*8+G2%:D2%=B2%':PSET(0,24):PRINT#1,"C1"C1%"C2"C2%"D1"D1%"D2"D2%
250 RETURN
1000 OUT8,&HAC:OUT8,1:L=LEN(D$)
1010 OUT8,L:FORI=1TOL:OUT8,ASC(MID$(D$,I,1)):NEXTI:OUT8,&HAB
1020 R=INP(8)+INP(8)*256:RETURN
2032 'DEFINE PALETTE COLORS
2036 P(0)=C1%:P(1)=C1%:P(2)=C1%:P(3)=C1%:P(4)=C2%:P(5)=C2%:P(6)=C2%:P(7)=C2%
2037 Q(0)=D1%:Q(1)=D1%:Q(2)=D1%:Q(3)=D1%:Q(4)=D2%:Q(5)=D2%:Q(6)=D2%:Q(7)=D2%
2038 RETURN
2040 'FRAME 1
2041 GOSUB 200:GOSUB2168:'GOSUB 2123
2042 GOSUB 2211
2043 '
2050 'FRAME 2
2051 GOSUB 2124
2052 GOSUB 2211
2053 'GOSUB 200
2060 'FRAME3
2061 GOSUB 2125
2062 GOSUB 2211
2063 'GOSUB 200
2070 'FRAME 4
2071 GOSUB 2126
2072 GOSUB 2211
2073 'GOSUB 210
2080 'FRAME 5
2081 GOSUB 2123
2082 GOSUB 2211
2083 'GOSUB 210
2090 'FRAME 6
2091 GOSUB 2124
2092 GOSUB 2211
2093 'GOSUB 210
2100 'FRAME 7
2101 GOSUB 2125
2102 GOSUB 2211
2103 'GOSUB 210
2110 'FRAME 8
2111 GOSUB 2126
2112 GOSUB 2211
2113 'GOSUB 210
2115 IF STICK(0)=7 THEN END
2117 GOTO 2041
2122 'SHIFT PALETTES
2123 T=P(0):P(0)=P(4):P(4)=T:T=Q(0):Q(0)=Q(4):Q(4)=T:RETURN
2124 T=P(1):P(1)=P(5):P(5)=T:T=Q(1):Q(1)=Q(5):Q(5)=T:RETURN
2125 T=P(2):P(2)=P(6):P(6)=T:T=Q(2):Q(2)=Q(6):Q(6)=T:RETURN
2126 T=P(3):P(3)=P(7):P(7)=T:T=Q(3):Q(3)=Q(7):Q(7)=T:RETURN
2168 P(0)=C2%:P(1)=C1%:P(2)=C1%:P(3)=C1%:P(4)=C1%:P(5)=C2%:P(6)=C2%:P(7)=C2%:Q(0)=D2%:Q(1)=D1%:Q(2)=D1%:Q(3)=D1%:Q(4)=D1%:Q(5)=D2%:Q(6)=D2%:Q(7)=D2%:RETURN
2169 P(0)=C2%:P(1)=C2%:P(2)=C1%:P(3)=C1%:P(4)=C1%:P(5)=C1%:P(6)=C2%:P(7)=C2%:Q(0)=D2%:Q(1)=D2%:Q(2)=D1%:Q(3)=D1%:Q(4)=D1%:Q(5)=D1%:Q(6)=D2%:Q(7)=D2%:RETURN
2210 ' ASSIGN PALETTES 
2211 VDP(17)=2:OUT&H9A,P(0):OUT&H9A,Q(0):VDP(17)=3:OUT&H9A,P(1):OUT&H9A,Q(1):VDP(17)=4 :OUT&H9A,P(2):OUT&H9A,Q(2):VDP(17)=5:OUT&H9A,P(3):OUT&H9A,Q(3)
2212VDP(17)=6:OUT&H9A,P(4):OUT&H9A,Q(4):VDP(17)=7:OUT&H9A,P(5):OUT&H9A,Q(5):VDP(17)=8:OUT&H9A,P(6):OUT&H9A,Q(6):VDP(17)=9:OUT&H9A,P(7):OUT&H9A,Q(7)
2213 'PSET(0,16):PRINT#1,"P(0)"P(0)"P(1)"P(1)"P(2)"P(2)"P(3)"P(3)"P(4)"P(4)"P(5)"P(5)"P(6)"P(6)"P(7)"P(7)
2216 'PSET(0,24):PRINT#1,"Q(0)"Q(0)"Q(1)"Q(1)"Q(2)"Q(2)"Q(3)"Q(3)"Q(4)"Q(4)"Q(5)"Q(5)"Q(6)"Q(6)"Q(7)"Q(7)
2220 RETURN