1 ' Copyright (c) 2	023 emef220 
2 ' Released under the MIT license
3 ' https://opensource.org/licenses/mit-license.php
401 CLS:DEFINTA-Z
411 DIM P%(10,16),Q%(10,16)
412 PT%=PEEK(&H7):W=1:FR%=15:CP%=0:EL%=316
420 COLOR15,0,0:SCREEN5
421 VDP(0)=0:VDP(1)=&H68:VDP(10)=VDP(10) AND &H7F
422 T=1:BASE(15)=0:BASE(17)=&H800:VDP(2)=0:VDP(4)=T
424 VDP(9)=VDP(9) OR &H22

430 DEFUSR=&H41:A=USR(0)
431 W=0:POKE&HFAF6,W
432 T=1+CP%:GOSUB 900:GOSUB920:VDP(4)=(T)AND31
433 I=T:FL$=MID$(STR$(I),2):BLOAD FL$,S:I=3+I:FL$=MID$(STR$(I),2):BLOAD FL$,S 
434 DEFUSR=&H44:A=USR(0) 

485 ONINTERVAL=FR%GOSUB500:INTERVALON:TIME=0
490 IFINKEY$=""GOTO490 ELSE END

500 VDP(4)=(T)AND31:T=T+1:GOSUB800:RETURN

800 IF T=EL% THEN GOSUB821:RETURN
801 IF TMOD4=0 THEN J=((T)AND31)\4:GOSUB 809
808 RETURN
809 ON J+1 GOSUB 810,811,811,811,812,811,811,811:T=T+1:RETURN
810 POKE&HFAF6,0:CP%=CP%+32:T=CP%+1:FL$=MID$(STR$(T),2):BLOAD FL$,S:RETURN
811 FL$=MID$(STR$(T),2):BLOAD FL$,S:RETURN
812 POKE&HFAF6,1:FL$=MID$(STR$(T),2):BLOAD FL$,S:RETURN
821 SCREEN0:PRINT "TIME"TIME:END

900 VP=&H0420
901 FOR H=CP%TOEL%STEP32
902 U=H+1:FL$=MID$(STR$(U),2):BLOAD FL$,S
903 FOR I=0 TO 15:P1=VPEEK(VP+I*2):P2=VPEEK(VP+I*2+1):P%(H/32,I)=P1:Q%(H/32,I)=P2:NEXTI
904 NEXT H:RETURN

910 H=(T-1)/32:FORI=0TO15:VDP(17)=I:OUTPT%+2,P%(H,I):OUTPT%+2,Q%(H,I):NEXTI:RETURN
920 FORI=0TO15:VDP(17)=I:OUTPT%+2,P%(0,I):OUTPT%+2,Q%(0,I):NEXTI:RETURN
