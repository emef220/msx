1 ' Copyright (c) 2	023 emef220 
2 ' Released under the MIT license
3 ' https://opensource.org/licenses/mit-license.php

10 CLS:COLOR 15,0,0: COLOR=NEW:SCREEN 5:OPEN "GRP:" FOR OUTPUT AS #1
20 DEFINTA-Z:SL%=0:EL%=6:OS%=&H800
30 D=0:W=1:C=2

60 'For Page 0 OffSet 0x800 7 frames
61 'CLS
62 SETPAGE,W:BLOAD"P0_0.SC5",S:COLOR=RESTORE
63 SETPAGE,D:GOSUB 330
64 PP%=0:OS%=&H800: SL%=0:EL%=6
65 GOSUB 600
66 GOSUB 800

70 'For Page 0 OffSet 0x4000 8frames
71 'CLS
72 SETPAGE,W:BLOAD"P0_4000.SC5",S:COLOR=RESTORE
73 SETPAGE,D:GOSUB 330
74 PP%=0:OS%=&H4000: SL%=0:EL%=7
75 GOSUB 600
76 GOSUB 800

80 'For Page 1 OffSet 0x0 8frames
81 'CLS
82 SETPAGE,W:BLOAD"P1_0.SC5",S:COLOR=RESTORE
83 SETPAGE,D:GOSUB 330
84 PP%=1:OS%=&H0: SL%=0:EL%=7
85 GOSUB 600
86 GOSUB 800

90 'For Page 1 OffSet 0x4000 8frames
91 'CLS
92 SETPAGE,W:BLOAD"P1_4000.SC5",S:COLOR=RESTORE
93 SETPAGE,D:GOSUB 330
94 PP%=1:OS%=&H4000: SL%=0:EL%=7
95 GOSUB 600
96 GOSUB 800

100 'For Page 2 OffSet 0x0 8frames
101 'CLS
102 SETPAGE,W:BLOAD"P2_0.SC5",S:COLOR=RESTORE
103 SETPAGE,D:GOSUB 330
104 PP%=2:OS%=&H0: SL%=0:EL%=7
105 GOSUB 600
106 GOSUB 800

110 'For Page 2 OffSet 0x4000 8frames
111 'CLS
112 SETPAGE,W:BLOAD"P2_4000.SC5",S:COLOR=RESTORE
113 SETPAGE,D:GOSUB 330
114 PP%=2:OS%=&H4000: SL%=0:EL%=7
115 GOSUB 600
116 GOSUB 800

120 'For Page 3 OffSet 0x0 8frames
121 'CLS
122 SETPAGE,W:BLOAD"P3_0.SC5",S:COLOR=RESTORE
123 SETPAGE,D:GOSUB 330
124 PP%=3:OS%=&H0: SL%=0:EL%=7
125 GOSUB 600
126 GOSUB 800

130 'For Page 3 OffSet 0x4000 8frames
131 'CLS
132 SETPAGE,W:BLOAD"P3_4000.SC5",S:COLOR=RESTORE
133 SETPAGE,D:GOSUB 330
134 PP%=3:OS%=&H4000: SL%=0:EL%=7
135 GOSUB 600
136 GOSUB 800

200 END

330 'DRAW BOUNDARY
340 X=0:C=2
345 FOR J=0 TO 12
350 FOR I=0 TO 127
360 VPOKE X+I,C
370 NEXT I:C=C+1:IF C=16 THEN C=2
380 X=X+&H800
390 NEXT J
400 RETURN

600 ' CONVERT
605 _TURBOON (SL%, EL%, OS%,C,D,W)
610 FOR L=SL% TO EL%
630 FOR K=0 TO 5' 
640 FOR J=0 TO 31'
650 FOR I=0 TO 7 '
660 SETPAGE,W:X1%=(LMOD4)*64+J*2:Y1%=I+K*8+(L\4)*64:A=Y1%*128+X1%\2:A=Y1%*128+X1%\2:P=VPEEK(A)
670 SETPAGE,D':PSET(X1%,Y1%),C:
680 AI%=I:AJ%=J*8:AK%=K*256:AL%=(L-SL%)*&H800:A=OS%+AI%+AJ%+AK%+AL%:VPOKEA,P
690 'X1%=AMOD128:Y1%=AÂ¥128':PSET(X1%,96+Y1%),C:PSET(X1%+1,96+Y1%),C
700 NEXT I:C=C+1:IF C=16 THEN C=2
710 NEXT J
720 NEXT K
730 NEXT L
740 _TURBOOFF
750 RETURN

800 ST%=OS%:ED=ST%+&H3FFF:IF P=0 AND ST%=&H800 THEN ED%=ED%-ST%
810 FL$="P"+MID$(STR$(PP%),2)+"_"+MID$(HEX$(ST%),1)+".SC3"
830 BSAVE FL$,ST%,ED,S
840 RETURN

930 'DRAW BOUNDARY
940 C=2
945 FOR J=0 TO 12
950 FOR I=0 TO 127
960 VPOKE T+I,C
970 NEXT I:C=C+1:IF C=16 THEN C=2
980 T=T+&H800
990 NEXT J
900 RETURN