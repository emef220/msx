1 ' Copyright (c) 2023 emef220 
2 ' Released under the MIT license
3 ' https://opensource.org/licenses/mit-license.php
4 '
5 ' --------------------------------------------------------------------------
6 ' 019 Hyper2 with analog volume (Refine)(Loop Unwinding)
7 ' --------------------------------------------------------------------------
8 '
10 CLS:COLOR 15,0,1:SCREEN 5:OPEN "GRP:" FOR OUTPUT AS #1
20 BLOAD "HYPER2.SC5",S
30 COLOR = RESTORE
40 DIM P(8):DIM Q(8):C1%=&H26:C2%=&H3:D1%=&H0:D2%=&H0
50 'D$="sample/analog":GOSUB1000
60 GOSUB 200: GOSUB 2036:GOTO 2040
70 IF INKEY$="" THEN 70
80 END
200 R=INT(RND(1)*4095)'GOSUB1000
209 PSET(0,0):PRINT#1,"R"R
210 R1%=(R\16)AND7:G1%=(R\8)AND7:B1%=(RAND15)AND7:PSET(0,8):PRINT#1,"R1"R1%"G1"G1%"B1"B1%
211 R2%=B1%:G2%=R1%:B2%=G1%:PSET(0,16):PRINT#1,"R2"R2%"G2"G2%"B2"B2%
212 C1%=R1%*8+G1%:C2%=B1%:D1%=R2%*8+G2%:D2%=B2%:PSET(0,24):PRINT#1,"C1"C1%"C2"C2%"D1"D1%"D2"D2%
250 RETURN
1000 OUT8,&HAC:OUT8,1:L=LEN(D$)
1010 OUT8,L:FORI=1TOL:OUT8,ASC(MID$(D$,I,1)):NEXTI:OUT8,&HAB
1020 R=INP(8)+INP(8)*256:RETURN
2020 ' DEFINE GRB COLOR
2022 C1=&H26:C2=&H3:D1=&H0:D2=&H0
2023 RETURN
2032 'DEFINE PALETTE COLORS
2036 P(0)=C1%:P(1)=C1%:P(2)=C1%:P(3)=C1%:P(4)=C2%:P(5)=C2%:P(6)=C2%:P(7)=C2%
2037 Q(0)=D1%:Q(1)=D1%:Q(2)=D1%:Q(3)=D1%:Q(4)=D2%:Q(5)=D2%:Q(6)=D2%:Q(7)=D2%
2038 RETURN
2040 'PALETTE ANIMATION
2041 GOSUB200:GOSUB 2022: GOSUB 2032
2042 GOSUB 2111: GOSUB 2211
2043 IF STICK(0)=7 THEN END
2044 GOTO 2042
2110 'S=P(7):T=Q(7):FOR I=7TO1STEP-1:P(I)=P(I-1):Q(I)=Q(I-1):NEXTI:P(0)=S:Q(0)=T:RETURN
2111 S=P(7):T=Q(7):P(7)=P(6):Q(7)=Q(6):P(6)=P(5):Q(6)=Q(5):P(5)=P(4):Q(5)=Q(4):P(4)=P(3):Q(4)=Q(3):P(3)=P(2):Q(3)=Q(2):P(2)=P(1):Q(2)=Q(1):P(1)=P(0):Q(1)=Q(0):P(0)=S:Q(0)=T:RETURN
2210 'FOR I=0TO7:VDP(17)=2+I:OUT&H9A,P(I):OUT&H9A,Q(I):NEXTI:RETURN
2211 VDP(17)=2:OUT&H9A,P(0):OUT&H9A,Q(0):VDP(17)=3:OUT&H9A,P(1):OUT&H9A,Q(1):VDP(17)=4:OUT&H9A,P(2):OUT&H9A,Q(2):VDP(17)=5:OUT&H9A,P(3):OUT&H9A,Q(3)
2212 VDP(17)=6:OUT&H9A,P(4):OUT&H9A,Q(4):VDP(17)=7:OUT&H9A,P(5):OUT&H9A,Q(5):VDP(17)=8:OUT&H9A,P(6):OUT&H9A,Q(6):VDP(17)=9:OUT&H9A,P(7):OUT&H9A,Q(7):RETURN