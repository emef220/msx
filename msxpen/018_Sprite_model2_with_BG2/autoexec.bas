1 ' Copyright (c) 2023 emef220 
2 ' Released under the MIT license
3 ' https://opensource.org/licenses/mit-license.php
4 '
5 ' --------------------------------------------------------------------------
6 ' 018_Sprite_model2_with_BG2
7 ' --------------------------------------------------------------------------
10 CLS:SCREEN 5,2,0:COLOR 15,0,1':OPEN "GRP:" FOR OUTPUT AS #1
20 '-- LOAD Back Ground
21 'CALL TURBO OFF
22 BLOAD "PSD3D4.SC5",S:COLOR=RESTORE
23 'CALL TURBO ON:
24 DIM A(8):DIM B(8):DIM X(8):DIM Y(8):DIM P(16):DIM Q(16):DIM SI%(32):DIM CO%(32)
30 '-- LOAD SPRITE GENERATOR & COLOR
31 GOSUB 910:GOSUB 921:GOSUB 22001
50 'DISPLAY SPRITE
52 X(0)=128-16:Y(0)=98-16
53 GOSUB 850
55 'ON INTERVAL=60 GOSUB 722
56 'INTERVAL ON
58 REM
60 '-- INITILIZE X & Y
61 X(0)=128-16:Y(0)=98-16
70 'GOTO MAIN ROUTINE
71 GOTO 2030
720 '-- UPDATE X & Y of SPRITES
721 'CALL TURBO ON
722 IF T%<32 THEN I%=T%:Y(0)=SI%(I%):GOTO 744
723 IF T%<64 THEN I%=T%-32:Y(0)=SI%(31-I%):GOTO 744
725 IF T%<96 THEN I%=T%-64:Y(0)=SI%(I%):GOTO 744
728 IF T%<128THEN I%=T%-96:Y(0)=SI%(31-I%):GOTO 744
729 IF T%=128THEN Y(0)=SI%(0):T%=1:A=&H7600:GOTO 744
730 S=STICK(0) 
741 IF S=1 THEN Y(0)=Y(0)-1 
742 IF S=3 THEN X(0)=X(0)+1 
743 IF S=5 THEN Y(0)=Y(0)+1 
744 'PRINT#1,"T"T%"I"I%"X"X(0)"Y"Y(0)"C"CO%(I%)"S"SI%(I%)
745 T%=T%+1
746 A=&H7600
747 X=X(0):Y=Y(0):FOR I=0 TO 2:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
748 X=16+X(0):Y=Y(0):FOR I=0 TO 2:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
749 X=X(0):Y=16+Y(0):FOR I=0 TO 2:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
750 X=16+X(0):Y=16+Y(0):FOR I=0 TO 2:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
751 X=X(0):Y=32+Y(0):FOR I=0 TO 2:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
752 X=16+X(0):Y=32+Y(0):FOR I=0 TO 1:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
753 X=X(0):Y=48+Y(0):FOR I=0 TO 1:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
754 X=16+X(0):Y=48+Y(0):FOR I=0 TO 1:VPOKE A,Y:VPOKE A+1,X:A=A+4:NEXT I
795 RETURN
850 '-- DISPLAY SPRITE
851 'SPRITEON DISPLAY ROUTINE
852 PUT SPRITE 0,(0+X(0),0+Y(0)),,0
853 PUT SPRITE 1,(0+X(0),0+Y(0)),,1
854 PUT SPRITE 2,(0+X(0),0+Y(0)),,2
855 PUT SPRITE 3,(16+X(0),0+Y(0)),,3
856 PUT SPRITE 4,(16+X(0),0+Y(0)),,4
857 PUT SPRITE 5,(16+X(0),0+Y(0)),,5
858 PUT SPRITE 6,(0+X(0),16+Y(0)),,6
859 PUT SPRITE 7,(0+X(0),16+Y(0)),,7
860 PUT SPRITE 8,(0+X(0),16+Y(0)),,8
861 PUT SPRITE 9,(16+X(0),16+Y(0)),,9
862 PUT SPRITE 10,(16+X(0),16+Y(0)),,10
863 PUT SPRITE 11,(16+X(0),16+Y(0)),,11
864 PUT SPRITE 12,(0+X(0),32+Y(0)),,12
865 PUT SPRITE 13,(0+X(0),32+Y(0)),,13
866 PUT SPRITE 14,(0+X(0),32+Y(0)),,14
867 PUT SPRITE 15,(16+X(0),32+Y(0)),,15
868 PUT SPRITE 16,(16+X(0),32+Y(0)),,16
869 PUT SPRITE 17,(0+X(0),48+Y(0)),,17
870 PUT SPRITE 18,(0+X(0),48+Y(0)),,18
871 PUT SPRITE 19,(16+X(0),48+Y(0)),,19
872 PUT SPRITE 20,(16+X(0),48+Y(0)),,20
873 RETURN
910 'SUBROUTILE: LOAD PALETTE
911 RESTORE 10000:FOR I=0 TO 15:READ A$:FOR J=1 TO 3
912 A(J)=VAL(MID$(A$,J,1)):NEXT J:COLOR=(I,A(1),A(2),A(3)):NEXT I
913 RETURN
920 'SUBROUTILE: LOAD SPRITE PATTERN
921 S0%=0':S=&H7800
922 READ A$: IF A$="*" THEN RETURN 
923 S1%=S0%:B$=CHR$(VAL(A$)):FOR I=1 TO 31:READ A$:B$=B$+CHR$(VAL(A$)):NEXTI:SPRITE$(S0%)=B$:S0%=S0%+1
930 'LOAD SPRITE COLOR
931 'SN%=0':S=&H7400
932 READ A$: IF A$="*" THEN RETURN
933 B$=CHR$(VAL(A$)):FOR I=1 TO 15:READ A$:B$=B$+CHR$(VAL(A$)):NEXTI:COLOR SPRITE$(S1%)=B$:S1%=S1%+1
934 'B$="":FOR I=0 TO 7:READ A$:B$=B$+CHR$(VAL(A$)):NEXT:COLOR SPRITE$(S1%)=B$:S1%=S1%+1
935 'S0%=S0%+1':PRINT#1,"SN%"SN%
936 GOTO 922
2030 ' INIT PALETTE COLOR
2032 'A=7:B=7:C=7:D=7:E=0:F=0:G=0:H=0:J=0:K=0:L=0:M=0:N=0:O=0:P=0:S=&H26:T=&H2:U=&H46:V=&H6
2036 P(0)=&H26:P(1)=&H26:P(2)=&H26:P(3)=&H26:P(4)=&H46:P(5)=&H46:P(6)=&H46:P(7)=&H46
2037 Q(0)=&H2:Q(1)=&H2:Q(2)=&H2:Q(3)=&H2:Q(4)=&H6:Q(5)=&H6:Q(6)=&H6:Q(7)=&H6
2040 'FRAME 1
2041 GOSUB 2123
2042 GOSUB 2216
2043 GOSUB 722
2050 'FRAME 2
2051 GOSUB 2124
2052 GOSUB 2216
2053 GOSUB 722
2060 'FRAME3
2061 GOSUB 2125
2062 GOSUB 2216
2063 GOSUB 722
2070 'FRAME 4
2071 GOSUB 2126
2072 GOSUB 2216
2073 GOSUB 722
2080 'FRAME 5
2081 GOSUB 2123
2082 GOSUB 2216
2083 GOSUB 722
2090 'FRAME 6
2091 GOSUB 2124
2092 GOSUB 2216
2093 GOSUB 722
2100'FRAME 7
2101 GOSUB 2125
2102 GOSUB 2216
2103 GOSUB 722
2110'FRAME 8
2111 GOSUB 2126
2112 GOSUB 2216
2113 GOSUB 722
2115 IF STICK(0)=7 THEN END
2117 GOTO 2041
2122 'SHIFT PALETTES
2123 T=P(0):P(0)=P(4):P(4)=T:T=Q(0):Q(0)=Q(4):Q(4)=T:RETURN
2124 T=P(1):P(1)=P(5):P(5)=T:T=Q(1):Q(1)=Q(5):Q(5)=T:RETURN
2125 T=P(2):P(2)=P(6):P(6)=T:T=Q(2):Q(2)=Q(6):Q(6)=T:RETURN
2126 T=P(3):P(3)=P(7):P(7)=T:T=Q(3):Q(3)=Q(7):Q(7)=T:RETURN
2210' ASSIGN PALETTES 
2211 'COLOR=(2,A,A,A):COLOR=(3,B,B,B):COLOR=(4,C,C,C):COLOR=(5,D,D,D)
2212 'COLOR=(6,E,E,E):COLOR=(7,F,F,F):COLOR=(8,G,G,G):COLOR=(9,H,H,H)
2216 VDP(17)=2:OUT&H9A,P(0):OUT&H9A,Q(0):VDP(17)=3:OUT&H9A,P(1):OUT&H9A,Q(1):VDP(17)=4 :OUT&H9A,P(2):OUT&H9A,Q(2):VDP(17)=5:OUT&H9A,P(3):OUT&H9A,Q(3)
2217 VDP(17)=6:OUT&H9A,P(4):OUT&H9A,Q(4):VDP(17)=7:OUT&H9A,P(5):OUT&H9A,Q(5):VDP(17)=8:OUT&H9A,P(6):OUT&H9A,Q(6):VDP(17)=9:OUT&H9A,P(7):OUT&H9A,Q(7)
2220 RETURN
10000 'PALETTE DATA
10010 DATA 000,000,161,373,117,237,511,267,711,733,771,117,711,664,112,777
12000 ' --- Slot 0
12010 ' mask 0
12020 DATA &H00,&H00,&H01,&H01,&H01,&H01,&H01,&H00
12030 DATA &H00,&H00,&H03,&H03,&H07,&H07,&H0F,&H0F
12040 DATA &HF8,&HFC,&HFC,&H00,&H80,&HFF,&HFF,&H3F
12050 DATA &HF7,&H6F,&H2F,&HCF,&HFF,&HFF,&HFF,&HFF
12060 ' attr 0
12070 DATA &H0A,&H0A,&H0A,&H0C,&H0C,&H0A,&H0A,&H0C
12080 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
12090 ' mask 1
12100 DATA &H00,&H00,&H00,&H00,&H02,&H00,&H00,&H00
12110 DATA &H00,&H01,&H03,&H00,&H00,&H00,&H00,&H00
12120 DATA &H00,&H00,&H00,&HFF,&H7F,&H01,&H03,&HFE
12130 DATA &HFC,&HFC,&HFC,&HF8,&H78,&H18,&H08,&H00
12140 ' attr 1
12150 DATA &H00,&H00,&H00,&H4A,&H4A,&H45,&H45,&H4A
12160 DATA &H4A,&H4A,&H4A,&H4B,&H43,&H43,&H43,&H00
12170 ' mask 2
12180 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12190 DATA &H00,&H01,&H03,&H00,&H00,&H00,&H00,&H00
12200 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H06
12210 DATA &H0C,&H9C,&HDC,&H00,&H00,&H00,&H00,&H00
12220 ' attr 2
12230 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H41
12240 DATA &H41,&H41,&H41,&H00,&H00,&H00,&H00,&H00
12250 ' 
12260 ' --- Slot 1
12270 ' mask 0
12280 DATA &H00,&H00,&H00,&H00,&H38,&HFE,&HFF,&HFF
12290 DATA &HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF
12300 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H80
12310 DATA &HC0,&HE0,&HF8,&HFC,&HFE,&HFF,&HFF,&HFE
12320 ' attr 0
12330 DATA &H00,&H00,&H00,&H00,&H0C,&H0C,&H0C,&H0C
12340 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
12350 ' mask 1
12360 DATA &H00,&H00,&H00,&H00,&H00,&H80,&H00,&H00
12370 DATA &H80,&HC0,&H40,&H60,&H78,&H37,&H6F,&HDF
12380 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12390 DATA &H00,&H00,&H00,&H00,&H00,&H80,&HF0,&HE0
12400 ' attr 1
12410 DATA &H00,&H00,&H00,&H00,&H00,&H43,&H00,&H00
12420 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
12430 ' mask 2
12440 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12450 DATA &H00,&H00,&H00,&H00,&H00,&H07,&H0F,&H1F
12460 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12470 DATA &H00,&H00,&H00,&H00,&H00,&H80,&HE0,&HE0
12480 ' attr 2
12490 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12500 DATA &H00,&H00,&H00,&H00,&H00,&H41,&H41,&H41
12510 ' 
12520 ' --- Slot 2
12530 ' mask 0
12540 DATA &H0F,&H07,&H07,&H07,&H07,&H03,&H01,&H01
12550 DATA &H01,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12560 DATA &HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF
12570 DATA &HFF,&H3F,&H1F,&H1F,&H0F,&H0F,&H1F,&H1F
12580 ' attr 0
12590 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
12600 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
12610 ' mask 1
12620 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12630 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12640 DATA &H01,&H07,&H0F,&H7F,&H7F,&H3F,&H3C,&H34
12650 DATA &H3C,&H2C,&H08,&H00,&H0E,&H07,&H03,&H03
12660 ' attr 1
12670 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
12680 DATA &H42,&H42,&H43,&H00,&H42,&H42,&H42,&H42
12690 ' mask 2
12700 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12710 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12720 DATA &H00,&H00,&H00,&H06,&H04,&H00,&H00,&H04
12730 DATA &H0C,&H0C,&H00,&H00,&H00,&H00,&H00,&H00
12740 ' attr 2
12750 DATA &H00,&H00,&H00,&H41,&H41,&H00,&H00,&H41
12760 DATA &H41,&H41,&H00,&H00,&H00,&H00,&H00,&H00
12770 ' 
12780 ' --- Slot 3
12790 ' mask 0
12800 DATA &HFC,&HE8,&HC4,&HCF,&HE8,&HE0,&HF8,&HFF
12810 DATA &HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF,&HFF
12820 DATA &HF0,&H40,&H40,&H80,&H00,&H00,&H00,&H80
12830 DATA &H80,&H80,&HC0,&HC0,&HC0,&HC0,&HC0,&HC0
12840 ' attr 0
12850 DATA &H0C,&H04,&H0C,&H0C,&H0E,&H0E,&H0E,&H0C
12860 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0E,&H0E,&H0C
12870 ' mask 1
12880 DATA &HFF,&HFF,&H3F,&HFC,&H1F,&H1F,&H07,&H7F
12890 DATA &H3F,&H13,&H01,&H31,&H3F,&H00,&H00,&HFE
12900 DATA &HE0,&HF0,&HF0,&HE0,&HE0,&HC0,&H80,&H80
12910 DATA &H80,&H80,&HC0,&HC0,&HC0,&H00,&H00,&H40
12920 ' attr 1
12930 DATA &H4A,&H4A,&H4A,&H4A,&H4B,&H4B,&H4B,&H42
12940 DATA &H42,&H42,&H42,&H42,&H42,&H00,&H00,&H42
12950 ' mask 2
12960 DATA &H3C,&H38,&H3C,&H3C,&H00,&H00,&H00,&H00
12970 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
12980 DATA &HE0,&H70,&H70,&HE0,&H00,&H00,&H00,&H00
12990 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13000 ' attr 2
13010 DATA &H41,&H41,&H41,&H41,&H00,&H00,&H00,&H00
13020 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13030 ' 
13040 ' --- Slot 4
13050 ' mask 0
13060 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13070 DATA &H00,&H00,&H01,&H03,&H03,&H03,&H07,&H07
13080 DATA &H1F,&H3F,&H3F,&H3F,&H7F,&H7F,&H7E,&H7E
13090 DATA &HFC,&HFC,&HFC,&HFC,&HF8,&HF8,&HF0,&HF0
13100 ' attr 0
13110 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13120 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13130 ' mask 1
13140 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13150 DATA &H00,&H00,&H00,&H01,&H01,&H00,&H00,&H00
13160 DATA &H03,&H03,&H07,&H07,&H0F,&H0F,&H1E,&H3E
13170 DATA &H1C,&H1C,&H88,&H1C,&H18,&H38,&H30,&H70
13180 ' attr 1
13190 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
13200 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
13210 ' mask 2
13220 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13230 DATA &H00,&H00,&H00,&H01,&H01,&H00,&H00,&H00
13240 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13250 DATA &H00,&H00,&H80,&H00,&H00,&H00,&H00,&H00
13260 ' attr 2
13270 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13280 DATA &H00,&H00,&H41,&H41,&H41,&H00,&H00,&H00
13290 ' 
13300 ' --- Slot 5
13310 ' mask 0
13320 DATA &H9F,&H9F,&H9F,&H1F,&H0F,&H0F,&H0F,&H0F
13330 DATA &H0F,&H0F,&H07,&H07,&H03,&H01,&H01,&H00
13340 DATA &HE0,&HE0,&HE0,&HE0,&HE0,&HE0,&HE0,&HE0
13350 DATA &HF0,&HF8,&HF8,&HF8,&HFC,&HFC,&HFE,&HFF
13360 ' attr 0
13370 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13380 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13390 ' mask 1
13400 DATA &H9E,&H9E,&H9E,&H1F,&H0F,&H0F,&H0F,&H0F
13410 DATA &H0F,&H0E,&H06,&H07,&H03,&H01,&H00,&H00
13420 DATA &H60,&H20,&H20,&H00,&H00,&H80,&HC0,&HC0
13430 DATA &H00,&H00,&H00,&H00,&H80,&H80,&HC0,&HF0
13440 ' attr 1
13450 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
13460 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H42,&H42
13470 ' 
13480 ' --- Slot 6
13490 ' mask 0
13500 DATA &H07,&H0F,&H0F,&H1F,&H1F,&H3F,&H3F,&H7F
13510 DATA &H7F,&H7F,&HFE,&HFC,&HF8,&HF0,&H00,&H00
13520 DATA &HE0,&HE0,&HC0,&HC0,&HC0,&HC0,&H80,&H00
13530 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13540 ' attr 0
13550 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13560 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H00,&H00
13570 ' mask 1
13580 DATA &H00,&H01,&H03,&H01,&H00,&H00,&H10,&H0C
13590 DATA &H02,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13600 DATA &H60,&HC0,&HC0,&HC0,&HC0,&H00,&H00,&H00
13610 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13620 ' attr 1
13630 DATA &H42,&H42,&H42,&H42,&H42,&H00,&H42,&H42
13640 DATA &H42,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13650 ' 
13660 ' --- Slot 7
13670 ' mask 0
13680 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13690 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13700 DATA &H7F,&H7E,&H7E,&H7C,&H7C,&H7C,&H7C,&H7C
13710 DATA &H78,&H70,&H00,&H00,&H00,&H00,&H00,&H00
13720 ' attr 0
13730 DATA &H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C,&H0C
13740 DATA &H0C,&H0C,&H00,&H00,&H00,&H00,&H00,&H00
13750 ' mask 1
13760 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13770 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13780 DATA &H60,&H60,&H7C,&H6C,&H40,&H40,&H00,&H00
13790 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13800 ' attr 1
13810 DATA &H42,&H42,&H42,&H42,&H42,&H42,&H00,&H00
13820 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
13830 DATA *
22000 '-- LOAD SI TABLE
22001 RESTORE 24003:FOR I=0 TO 31:READ A$:CO%(I)=VAL("&H"+A$):NEXTI
22002 RESTORE 25003:FOR I=0 TO 31:READ A$:SI%(I)=VAL("&H"+A$):NEXTI
22100 RETURN
24002 ' COS TABLE : 0-90 (32 STEPS) 
24003 DATA 40,3F,3F,3F,3E,3E,3D,3C
24004 DATA 3B,39,38,36,35,33,31,2F
24005 DATA 2D,2A,28,26,23,20,1E,1B
24006 DATA 18,15,12,0F,0C,09,06,03
25002 ' SIN TABLE : 0-90 (32 STEPS) 
25003 DATA 00,03,06,09,0C,0F,12,15
25004 DATA 18,1B,1E,20,23,26,28,2A
25005 DATA 2D,2F,31,33,35,36,38,39
25006 DATA 3B,3C,3D,3E,3E,3F,3F,3F